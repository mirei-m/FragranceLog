<div class="comment-item py-3 border-b border-gray-100 last:border-b-0">
  <div class="flex items-start space-x-3">
    <!-- 小さめのアイコン -->
    <div class="w-6 h-6 rounded-full flex-shrink-0 mt-1">
      <% if comment.user.profile_image.attached? %>
        <%= image_tag comment.user.profile_image,
              alt: comment.user.name,
              class: "w-full h-full object-cover rounded-full" %>
      <% else %>
        <div class="bg-neutral text-neutral-content rounded-full w-6 h-6 flex items-center justify-center">
          <i class="fa-solid fa-user text-xs"></i>
        </div>
      <% end %>
    </div>

    <!-- コンテンツ -->
    <div class="flex-1">
      <div class="flex items-baseline justify-between">
        <!-- 左側：ユーザー情報 -->
        <div class="flex items-baseline space-x-2">
          <span class="text-sm font-medium text-gray-900">
            <%= comment.user.name.presence || "匿名" %>
          </span>
          <span class="text-xs text-gray-500">
            <%= time_ago_in_words(comment.created_at) %>前
          </span>
        </div>

        <!-- 右側：編集・削除ボタン -->
        <% if current_user && current_user.own?(comment) %>
          <div class="flex items-center space-x-1">

            <!-- 編集ボタン -->
            <%= link_to edit_comment_path(comment),
                  data: { turbo_method: :get },
                  class: "text-blue-500 hover:text-blue-700 p-1 rounded hover:bg-blue-50 transition-colors duration-200",
                  title: "編集" do %>
              <i class="fas fa-edit" style="color: #74C0FC;"></i>
            <% end %>

            <!-- 削除ボタン -->
            <%= link_to comment_path(comment),
              data: {
                turbo_method: :delete,
                turbo_confirm: "本当に削除しますか？"
              },
              class: "text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors duration-200",
              title: "削除" do %>
              <i class="fas fa-trash-alt" style="color: #f4a69e;"></i>
            <% end %>
          </div>
        <% end %>
      </div>

      <!-- コメント本文 -->
      <div class="text-sm text-gray-700">
        <% limit = request.user_agent.match?(/Mobile/) ? 100 : 200 %>
        <% if comment.body.length > limit %>
          <div id="comment-body-<%= comment.id %>">
            <p><%= simple_format(truncate(comment.body, length: 200)) %></p>
            <button onclick="toggleComment(<%= comment.id %>)"
                    class="text-blue-600 hover:underline text-xs mt-1">
              続きを読む
            </button>
          </div>
          <div id="comment-full-<%= comment.id %>" style="display: none;">
            <p><%= simple_format(comment.body) %></p>
            <button onclick="toggleComment(<%= comment.id %>)"
                    class="text-blue-600 hover:underline text-xs mt-1">
              折りたたむ
            </button>
          </div>
        <% else %>
          <p><%= simple_format(comment.body) %></p>
        <% end %>
      </div>
    </div>
  </div>
</div>